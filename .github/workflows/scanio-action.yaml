name: "Scanio over Semgrep"

on:
  push:
    branches: [ "main", "japroc/update-ci-workflows"]
  pull_request:
    # The branches below must be a subset of the branches above
    branches: [ "main", "japroc/update-ci-workflows"]
  schedule:
    - cron: '37 10 * * 5'

jobs:
  scanio-action-job:
    runs-on: ubuntu-latest
    name: A job to test scanio action
    # permissions:
    #   packages: read
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Scanio analyze
        id: scanio-action
        uses: scan-io-git/scanio-action/analyze@v0.1.0
        with:
          scanner: semgrep

      - name: Upload SARIF results
        uses: github/codeql-action/upload-sarif@v2
        with:
          sarif_file: '.'
      
      # run ls for workspace folder
      - name: List files in workspace
        run: ls -la
      
      - name: Scanio to html
        uses: scan-io-git/scanio-action/to-html@75396dd14d4609e6869ff83f3325c3d1f7bad39e
        with:
          input: scanio-report-semgrep.sarif
          output: scanio-report-semgrep.html

      - name: Upload scanio report
        uses: actions/upload-artifact@v4
        with:
          name: scanio-report
          path: scanio-report-semgrep.html
